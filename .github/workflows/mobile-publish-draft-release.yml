name: "Auto-publish draft releases"

on:
    release:

permissions:
    contents: write

jobs:
    publish-release:
        runs-on: ubuntu-latest
        # Only run if the release is a draft
        if: github.event.release.draft == true
        steps:
            - name: Publish release
              uses: actions/github-script@v7
              with:
                  script: |
                      await github.rest.repos.updateRelease({
                          owner: context.repo.owner,
                          repo: context.repo.repo,
                          release_id: context.payload.release.id,
                          draft: false
                      });
                      
                      console.log(`Published release: ${context.payload.release.tag_name}`);
